<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>[WebGL] Grimoire.js でハーモノグラフみたいな何かを描いてみるテスト（シェーダ編） - js do it</title>
<meta name="Description" content="" />
<meta name="Keywords"  content="" />

<link rel="stylesheet" type="text/css" media="screen,print" href="style.css" />
</head>
<body>
<!-- generated by: jsdo.it - http://jsdo.it/cx20/wG9h -->
<!-- Copyright cx20 - http://jsdo.it/cx20 -->
<!-- Licensed under MIT License - http://www.opensource.org/licenses/mit-license.php -->
<!-- grimoire-preset-basic.js v1.10.19 -->
<script src="https://unpkg.com/grimoirejs-preset-basic@1.10.19/register/grimoire-preset-basic.js"></script>

<script type="text/sort" id="shader" typeName="harmonographShader">
@Pass{
    FS_PREC(mediump,float)
    @Disable(CULL_FACE)
    varying vec4 vColor;
    varying float vTime;

#ifdef VS
    @POSITION
    attribute vec3 position;
    uniform mat4 _matPVM;
    uniform float _time;

    void main(){
        float A1 = 0.2, f1 = 2.0, p1 = 1.0/16.0,  d1 = 0.02;
        float A2 = 0.2, f2 = 2.0, p2 = 3.0/2.0,   d2 = 0.0315;
        float A3 = 0.2, f3 = 2.0, p3 = 13.0/15.0, d3 = 0.02;
        float A4 = 0.2, f4 = 2.0, p4 = 1.0,       d4 = 0.02;

        vec3 p = position;
    
        f1 = sin(_time/1000.0);
        f2 = mod(_time/1000.0, 0.5);
        f3 = mod(_time/1000.0, 1.0);
        f4 = 1.0;
        p1 = _time/1000.0;
        
        float t = ((p.x/360.0) - 0.5)  * 50.0;
        float x = A1 * sin(f1 * t + PI * p1) * exp(-d1 * t) + A2 * sin(f2 * t + PI * p2) * exp(-d2 * t);
        float y = A3 * sin(f3 * t + PI * p3) * exp(-d3 * t) + A4 * sin(f4 * t + PI * p4) * exp(-d4 * t);
        float z = A1 * cos(f1 * t + PI * p1) * exp(-d1 * t) + A2 * cos(f2 * t + PI * p2) * exp(-d2 * t);
    
        p.x = x;
        p.y = y;
        p.z = z;
    
        vColor = vec4(x + 0.5, y + 0.5, z + 0.5, 1.0);
    
        gl_Position = _matPVM * vec4(p * 3.0, 1.0);
    }
#endif

#ifdef FS
    void main(){
        gl_FragColor = vec4(vColor);
    }
#endif
}
</script>

<script type="text/goml" id="canvas">
  <goml width="fit" height="fit" bgColor="black">
    <goml.components>
    </goml.components>
  <geometry type="custom" name="c1"/>
  <!-- <import-material typeName="harmonographShader" src="http://jsrun.it/assets/E/c/C/V/EcCVN"/> -->
    <scene>
      <camera>
        <camera.components>
          <MouseCameraControl/>
        </camera.components>
      </camera>
      <mesh material="new(harmonographShader)" geometry="c1"/>
    </scene>
  </goml>
</script>


<script type="text/javascript" src="index.js"></script>
</body>
</html>
