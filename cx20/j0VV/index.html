<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>[簡易版] GLSL でパーティクルの形を変えてみるテスト（その４） - js do it</title>
<meta name="Description" content="" />
<meta name="Keywords"  content="" />

<link rel="stylesheet" type="text/css" media="screen,print" href="style.css" />
</head>
<body>
<!-- generated by: jsdo.it - http://jsdo.it/cx20/j0VV -->
<!-- Copyright cx20 - http://jsdo.it/cx20 -->
<!-- Licensed under MIT License - http://www.opensource.org/licenses/mit-license.php -->
<script id="vs" type="x-shader/x-vertex">
attribute vec3 position;
uniform mat4 matPerspective;
uniform float time;
varying vec4 vColor;
varying float vTime;

void main()
{
    vec3 p = position;
    vColor = vec4(p.x+0.5, p.y/2.0+0.5, p.z+0.5, 1.0);
    vTime = time;
    
    p.y += 1.0 * mod(time * 0.2, 2.0);
    if ( p.y > 1.0 ) {
        p.y -= 2.0;
    }
    gl_Position = matPerspective * vec4(p, 1.0);
    
    gl_PointSize = 16.0 + 4.0 * ( 1.0 / length( gl_Position.xyz ) );
}
</script>

<script id="fs" type="x-shader/x-fragment">
// forked from http://glslsandbox.com/e#5875.4
precision mediump float;
varying vec4 vColor;
varying vec3 vPosition;
varying float vTime;
uniform vec2  resolution; // resolution

vec3 clover( float x, float y )
{
    float a = atan(x,y);
    float r = sqrt(x*x+y*y);
    float s = 0.5 + 0.5*sin(3.0*a);
    float g = sin(1.57+3.0*a);
    float d = 0.3 + 0.6*sqrt(s) + 0.15*g*g;
    float h = r/d;
    float f = 1.0-smoothstep( 0.95, 1.0, h );
    h *= 1.0-0.5*(1.0-h)*smoothstep(0.95+0.05*h,1.0,sin(3.0*a));
    return mix( vec3(0.0), vec3(0.5*h,0.2+0.2*h,0.0), f );
}

void main( void ) {
    float time = vTime;
    vec2 center = vec2(0.5, 0.5);
    vec2 p = (gl_PointCoord.xy - center) * 2.0;

    float a = time*5.0;
    p = vec2(p.x*cos(a)-p.y*sin(a), p.y*cos(a)+p.x*sin(a));
    vec3 col = clover(p.x, p.y);
    
    if (col.r > 0.1 || col.g > 0.1 || col.b > 0.1) {
        gl_FragColor = vec4(col.rgb, 1.0);
    } else {
        discard;
    }
}
</script>

<!-- stats.js r12 -->
<script src="../../assets/o/L/t/z/oLtzH.js"></script>

<canvas id="c" width="465" height="465"></canvas>

<script type="text/javascript" src="index.js"></script>
</body>
</html>
