<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>[WebGL] Grimoire.js で ammo.js を試してみるテスト（その４）（調整中） - js do it</title>
<meta name="Description" content="" />
<meta name="Keywords"  content="" />

<link rel="stylesheet" type="text/css" media="screen,print" href="style.css" />
</head>
<body>
<!-- generated by: jsdo.it - http://jsdo.it/cx20/Ai8D8 -->
<!-- Copyright cx20 - http://jsdo.it/cx20 -->
<!-- Licensed under MIT License - http://www.opensource.org/licenses/mit-license.php -->
<!-- grimoire-preset-basic.js v1.10.18 -->
<!-- <script src="https://unpkg.com/grimoirejs-preset-basic@1.8.8/register/grimoire-preset-basic.js"></script> -->
<script src="https://unpkg.com/grimoirejs-preset-basic@1.10.18/register/grimoire-preset-basic.js"></script>
<script src="https://unpkg.com/grimoirejs-forward-shading@1.7.3/register/grimoire-forward-shading.js"></script>

<!-- ammo.js -->
<!-- <script src="https://rawcdn.githack.com/kripken/ammo.js/55facf500316160ea9f5931a41e5d4678caf0ac0/builds/ammo.js"></script> -->
<script src="https://rawcdn.githack.com/kripken/ammo.js/master/builds/ammo.js"></script>

<script type="text/sort" id="shader" typeName="lambert">
@Pass{
    @DepthFunc(LEQUAL)
    @BlendFunc(SRC_ALPHA,ONE_MINUS_SRC_ALPHA)
    @CullFace(BACK)

    FS_PREC(mediump,float)

    varying vec2 vTexCoord;
    varying vec3 vNormal;

    #ifdef VS
      attribute vec3 position;
      attribute vec3 normal;
      attribute vec2 texCoord;
      uniform mat4 _matPVM;
      uniform mat4 _matM;
      void main(){
        gl_Position = _matPVM * vec4(position, 1.);
        vTexCoord = texCoord;
        vNormal = (_matM * vec4(normal, 0.)).xyz;
      }
    #endif

    #ifdef FS
      @{usedFlag:"_textureUsed"}
      uniform sampler2D texture;
      uniform bool _textureUsed;
      @{type:"color", default:"#6E183D"}
      uniform vec4 color;
      @{type:"vec3", default:"n(1,1,1)"}
      uniform vec3 sun;
      void main(){
        vec3 diffuse = max(dot(vNormal, -1. * sun), 0.3) * color.rgb;
        if (_textureUsed) {
          diffuse = diffuse * texture2D(texture, vTexCoord).rgb;
        }
        gl_FragColor = vec4(diffuse, 1.0);
      }
    #endif
}
</script>

<script type="text/goml" id="main">
  <goml width="fit" height="fit">
      <!-- <import-material typeName="lambert" src="http://jsrun.it/assets/o/X/e/h/oXehW" /> -->
      <material id="red"   type="lambert" color="#f00" sun="n(1,-1.1,-100)" />
      <material id="green" type="lambert" color="#0f0" sun="n(1,-1.1,-100)" />
      <material id="blue"  type="lambert" color="#00f" sun="n(1,-1.1,-100)" />
      <material id="BK"    type="lambert" color="#DCAA6B" sun="n(1,-1.1,-10)" /> <!-- black -->
      <material id="WH"    type="lambert" color="#FFFFFF" sun="n(1,-1.1,-10)" /> <!-- white -->
      <material id="BG"    type="lambert" color="#FFCCCC" sun="n(1,-1.1,-10)" /> <!-- beige -->
      <material id="BR"    type="lambert" color="#800000" sun="n(1,-1.1,-10)" /> <!-- brown -->
      <material id="RD"    type="lambert" color="#FF0000" sun="n(1,-1.1,-10)" /> <!-- red -->
      <material id="YL"    type="lambert" color="#FFFF00" sun="n(1,-1.1,-10)" /> <!-- yellow -->
      <material id="GN"    type="lambert" color="#00FF00" sun="n(1,-1.1,-10)" /> <!-- green -->
      <material id="WT"    type="lambert" color="#00FFFF" sun="n(1,-1.1,-10)" /> <!-- water -->
      <material id="BL"    type="lambert" color="#0000FF" sun="n(1,-1.1,-10)" /> <!-- blue -->
      <material id="PR"    type="lambert" color="#800080" sun="n(1,-1.1,-10)" /> <!-- purple -->
      <scene>
          <camera class="camera" near="0.01" far="40.0" aspect="1.0" fovy="45d" position="0,5,25" rotation="y(0d)">
              <camera.components>
                  <MouseCameraControl></MouseCameraControl>
              </camera.components>
          </camera>
          <light rotation="x(-30d)" color="white" type="directional" position="0,10,0" intensity="3"/>
          <mesh geometry="cube" position="0,-5,0" scale="20, 0.5, 20" texture="../../assets/u/y/G/y/uyGy9.jpg">
              <mesh.components>
                  <Rigid move="false"></Rigid>
              </mesh.components>
          </mesh>
      </scene>
  </goml>
</script>


<script type="text/javascript" src="index.js"></script>
</body>
</html>
