<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>GLSL で正弦波を描いてみるテスト（その４） - js do it</title>
<meta name="Description" content="" />
<meta name="Keywords"  content="" />

<link rel="stylesheet" type="text/css" media="screen,print" href="style.css" />
</head>
<body>
<!-- generated by: jsdo.it - http://jsdo.it/cx20/2S6I -->
<!-- Copyright cx20 - http://jsdo.it/cx20 -->
<!-- Licensed under MIT License - http://www.opensource.org/licenses/mit-license.php -->
<!DOCTYPE html><script id="f" type="x/f">
#ifdef GL_ES
precision mediump float;
#endif

uniform float t; // time;
uniform vec2  r; // resolution;

#define PI 3.14159265358979

float plot(float x, float y, vec2 p)
{
    if (distance(vec2(x, y), p) < 0.01)
        return 1.0;
    return 0.0;
}

void main( void ) {
    vec2 p = (gl_FragCoord.xy / r.xy) - vec2(0.5, 0.5);
    vec3 color;
    float r, g, b;

    // graph
    if ( mod(p.y, 0.1) < 0.002 || mod(p.x, 0.1) < 0.002)
    {
        color += vec3(0.0, 0.5, 0.0);
    }

    // sin curve
    g += plot(
        p.x,
        0.3 * sin( 2.0 * PI * p.x * 1.0 + t ), 
        p );

    r += plot(
        0.3 * cos( 2.0 * PI * p.y * 1.0 + t ), 
        p.y,
        p );

    b += plot(
        0.3 * cos( 2.0 * PI * p.y * 1.0 + t ), 
        0.3 * sin( 2.0 * PI * p.x * 1.0 + t ), 
        p );

    color += vec3(r*0.2, g*0.2, b);

    gl_FragColor = vec4(color, 1.0);
}
</script><script id="v" type="x/v">attribute vec3 p;void main(){gl_Position=vec4(p,1.);}</script><script>w=window;w.onload=function(){b=function(s){return document.getElementById(s)};w.addEventListener('keydown',k,1);c=b('c');g=c.getContext('webgl')||c.getContext('experimental-webgl');p=g.createProgram();h=function(i,j){k=g.createShader(35633-i);g.shaderSource(k,j);g.compileShader(k);g.attachShader(p,k);return g.getShaderInfoLog(k);};if(!h(0,b('v').text)&&!h(1,b('f').text)){g.linkProgram(p);}e=g.getProgramParameter(p, 35714);g.useProgram(p);u={};u.t=g.getUniformLocation(p,'t');u.r=g.getUniformLocation(p,'r');g.bindBuffer(34962,g.createBuffer());g.bufferData(34962,new Float32Array([-1,1,0,-1,-1,0,1,1,0,1,-1,0]),35044);a=g.getAttribLocation(p,'p');g.enableVertexAttribArray(a);g.vertexAttribPointer(a,3,5126,0,0,0);g.clearColor(0,0,0,1);z=Date.now();(function(){if(!e){return;}c.width=x=w.innerWidth;c.height=y=w.innerHeight;g.viewport(0,0,x,y);d=(Date.now()-z)*.001;g.clear(16384);g.uniform1f(u.t,d);g.uniform2fv(u.r,[x,y]);g.drawArrays(5,0,4);g.flush();requestAnimationFrame(arguments.callee);})();function k(h){e=(h.keyCode!==27);}};</script><style>*{margin:0;padding:0;overflow:hidden}html,body{height:100%}</style><canvas id="c"></canvas>

<script type="text/javascript" src="index.js"></script>
</body>
</html>
